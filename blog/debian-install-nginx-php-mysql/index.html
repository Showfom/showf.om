<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="Showfom Guo"><meta name="description" content="Showfom&#39;s personal weblog"><meta name="keywords" content="blog,debian,ubuntu,linux,domain hack"><base href="https://showf.om"><title>How to Install Nginx, MySQL and PHP (LEMP Stack) on Debian 9 / Debian 8 · Showfom&#39;s Blog</title><link rel="canonical" href="https://showf.om/blog/debian-install-nginx-php-mysql/"><style>html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}*,:after,:before{box-sizing:inherit}html{box-sizing:border-box;font-size:62.5%}body{display:flex;color:#323232;background-color:#fefefe;font-family:Ubuntu,monospace;font-size:1.6em;font-weight:400;letter-spacing:.0625em;line-height:1.8em}@media only screen and (min-device-width:320px) and (max-device-width:480px){body{font-size:1.4em;line-height:1.6em}}a{font-weight:700;color:#000;text-decoration:none}a:focus,a:hover{text-decoration:underline}p{margin:1.6rem 0 1.6rem 0}h1,h2,h3,h4,h5,h6{color:#000;text-transform:uppercase;letter-spacing:.0625em;margin:3.2rem 0 1.6rem 0}h1{font-size:3.2rem;line-height:3.2rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h1{font-size:2.8rem;line-height:2.8rem}}h2{font-size:2.8rem;line-height:2.8rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h2{font-size:2.4rem;line-height:2.4rem}}h3{font-size:2.4rem;line-height:2.4rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h3{font-size:2rem;line-height:2rem}}h4{font-size:2.2rem;line-height:2.2rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h4{font-size:1.8rem;line-height:1.8rem}}h5{font-size:2rem;line-height:2rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){h5{font-size:1.6rem;line-height:1.6rem}}h6{font-size:1.4rem;line-height:1.4rem}pre{margin:1.6rem 0 1rem 0;padding:1.6rem;overflow-x:auto}code{background-color:#000;color:#fefefe;padding:.4rem .8rem .4rem .8rem}blockquote{border-left:2px solid #dcdcdc;padding-left:1.6rem;font-style:italic}img{max-width:100%}.wrapper{display:flex;flex-direction:column;min-height:100vh;width:100%}.container{margin:0 auto;max-width:120rem;width:100%;padding-left:2rem;padding-right:2rem}.navigation{height:6rem;width:100%}.navigation a{display:inline;font-size:1.6rem;text-transform:uppercase;line-height:6rem;letter-spacing:.1rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){.navigation a{font-size:1.4rem}}.navigation ul{list-style:none;margin-bottom:0;margin-top:0}.navigation ul li{float:left;margin:0;position:relative}.navigation ul li a{margin-left:1rem;margin-right:1rem}.content{flex:1;margin-top:1.6rem;margin-bottom:3.2rem}.content article header{margin-top:3.2rem;margin-bottom:3.2rem}.content article header h1,.content article header h2{margin:0}.content article header h2{margin-top:1rem;font-size:1.8rem;color:#323232}@media only screen and (min-device-width:320px) and (max-device-width:480px){.content article header h2{font-size:1.6rem}}.list ul{margin:3.2rem 0 3.2rem 0;list-style:none;padding:0}.list ul li{font-size:1.6rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){.list ul li{font-size:1.4rem;margin:1.6rem 0 1.6rem 0}}.list ul li span{display:inline-block;text-align:right;width:20rem;margin-right:3rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){.list ul li span{display:block;text-align:left}}.list ul li a{text-transform:uppercase}.pagination{margin-top:6rem;text-align:center}.pagination li{display:inline;text-align:center}.pagination li span{margin:0;text-align:center;width:3.2rem}.pagination li a span{margin:0;text-align:center;width:3.2rem}.centered{display:flex;height:100%;align-items:center;justify-content:center}.centered .about{text-align:center}.centered .about h1{margin-top:2rem;margin-bottom:.5rem}.centered .about h2{margin-top:1rem;margin-bottom:.5rem;font-size:2.4rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){.centered .about h2{font-size:2rem}}.centered .about ul{list-style:none;margin:3rem 0 1rem 0;padding:0}.centered .about ul li{display:inline;position:relative}.centered .about ul li a{text-transform:uppercase;margin-left:1rem;margin-right:1rem;font-size:1.6rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){.centered .about ul li a{font-size:1.4rem}}.centered .error{text-align:center}.centered .error h1{margin-top:2rem;margin-bottom:.5rem;font-size:4.6rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){.centered .error h1{font-size:3.2rem}}.centered .error h2{margin-top:2rem;margin-bottom:3.2rem;font-size:3.2rem}@media only screen and (min-device-width:320px) and (max-device-width:480px){.centered .error h2{font-size:2.8rem}}.footer{height:6rem;width:100%;text-align:center;line-height:6rem}.float-right{float:right}.float-left{float:left}.highlight code{background-color:#000;color:#fefefe;padding:0}</style><meta name="msapplication-config" content="https://cdn.loli.net/sb.sb.sb/favicon/browserconfig.xml"><meta name="apple-mobile-web-app-title" content="Showfom's Blog"><meta name="application-name" content="Showfom's Blog"><meta name="theme-color" content="#ffffff"><link rel="icon" type="image/x-icon" href="https://cdn.loli.net/sb.sb.sb/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="https://cdn.loli.net/sb.sb.sb/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.loli.net/sb.sb.sb/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.loli.net/sb.sb.sb/favicon/favicon-16x16.png"><link rel="manifest" href="https://cdn.loli.net/sb.sb.sb/favicon/manifest.json"><link rel="mask-icon" href="https://cdn.loli.net/sb.sb.sb/favicon/safari-pinned-tab.svg" color="#5bbad5"><meta name="generator" content="Hugo 0.38.2"></head><body><main class="wrapper"><nav class="navigation"><section class="container"><a class="navigation-title" href="https://showf.om/">Showfom&#39;s Blog</a><ul class="navigation-list float-right"><li class="navigation-item"><a class="navigation-link" href="https://showf.om/blog/">Blog</a></li><li class="navigation-item"><a class="navigation-link" href="https://showf.om/about/">About</a></li><li class="navigation-item"><a class="navigation-link" href="https://showf.om/contact/">Contact</a></li></ul></section></nav><div class="content"><section class="container page"><article><header><h1>How to Install Nginx, MySQL and PHP (LEMP Stack) on Debian 9 / Debian 8</h1></header><p><a href="https://www.debian.org/releases/stretch/">Debian 9 Stretch</a> was released on June 18, 2017. Because it&rsquo;s the latest operating system, the old LEMP (Linux + Nginx + MySQL + PHP) installation tutorials based on <a href="https://www.dotdeb.org">Dotdeb</a> have become obsolete. This article will demonstrate how to install the latest version of LEMP on Debian 9.x Stretch using both official and third-party repositories. You will be able to select your preferred version of PHP.</p><p><strong>This article is also applicable to Debian 8.x Jessie, if your service provider has not supported Debian 9.x.</strong></p><p>We recommend you following the instructions as the root user. To switch to the root user, use the command <code>sudo -i</code>.</p><p>If you installed Debian 9 with ISO and set a root password, the <code>sudo</code> package would not be preinstalled. You can install <code>sudo</code> using the command <code>apt-get install sudo</code>.</p><h2 id="1-update-the-system-and-install-prerequisite-software">1. Update the system and install prerequisite software</h2><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get update &amp;&amp; apt-get upgrade
sudo apt-get install curl vim wget unzip apt-transport-https lsb-release ca-certificates</code></pre></div><p>You can also add the <a href="https://backports.debian.org">Debian Backports</a> repo for your convenience.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo cat &gt;&gt; /etc/apt/sources.list.d/backports.list <span style="color:#0086d2">&lt;&lt; EOF
</span><span style="color:#0086d2">deb http://deb.debian.org/debian $(lsb_release -sc)-backports main
</span><span style="color:#0086d2">deb-src http://deb.debian.org/debian $(lsb_release -sc)-backports main
</span><span style="color:#0086d2">EOF</span></code></pre></div><p>Then execute the update:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get -t stretch-backports update &amp;&amp; apt-get -t stretch-backports upgrade</code></pre></div><h2 id="2-install-nginx-from-ondřej-surý-s-repository">2. Install Nginx from Ondřej Surý&rsquo;s repository</h2><p>We recommend using the Nginx repository from Czech developer <a href="https://deb.sury.org/">Ondřej Surý</a>.</p><h3 id="2-1-add-surý-s-pgp-key">2.1 Add Surý’s PGP key</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo wget -O /etc/apt/trusted.gpg.d/nginx-mainline.gpg https://packages.sury.org/nginx-mainline/apt.gpg</code></pre></div><h3 id="2-2-add-nginx-repo">2.2 Add Nginx repo</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo cat &gt;&gt; /etc/apt/sources.list.d/nginx.list <span style="color:#0086d2">&lt;&lt; EOF
</span><span style="color:#0086d2">deb https://packages.sury.org/nginx-mainline/ $(lsb_release -sc) main
</span><span style="color:#0086d2">EOF</span></code></pre></div><p>If your server is located in Asia, use the mirror from <a href="https://xtom.com.hk/">xTom</a>:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo cat &gt;&gt; /etc/apt/sources.list.d/nginx.list <span style="color:#0086d2">&lt;&lt; EOF
</span><span style="color:#0086d2">deb https://mirror.xtom.com.hk/sury/nginx-mainline/ $(lsb_release -sc) main
</span><span style="color:#0086d2">EOF</span></code></pre></div><h3 id="2-3-undate-and-install-nginx">2.3 Undate and install Nginx</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get update
sudo apt-get install nginx-extras</code></pre></div><p>After installation, you should see the current Nginx version with the command <code>nginx -v</code> (1.13.5).</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@debian9 ~ <span style="color:#080;background-color:#0f140f;font-style:italic"># nginx -v
</span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>nginx version: nginx/1.13.5</code></pre></div><h3 id="2-4-cautions">2.4 Cautions</h3><p>Debian 9&rsquo;s Backports also offers Nginx updates, but they are slow. However, due to the high priority of Backports, if the two versions are the same, the Backports repository will be updated by default. Therefore, we need to decrease the priority of Backports.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo cat &gt;&gt; /etc/apt/preferences <span style="color:#0086d2">&lt;&lt; EOF
</span><span style="color:#0086d2">Package: nginx*
</span><span style="color:#0086d2">Pin: release a=stretch-backports
</span><span style="color:#0086d2">Pin-Priority: 499
</span><span style="color:#0086d2">EOF</span></code></pre></div><p>We need to manually let Nginx start at boot.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl enable nginx</code></pre></div><h2 id="3-add-ondřej-surý-s-php-repo-and-install-php-7-x">3. Add Ondřej Surý&rsquo;s PHP repo and install PHP 7.x</h2><p>The PHP repo from <a href="https://deb.sury.org/">Ondřej Surý</a> is convenient to use. Surý also maintains <a href="https://launchpad.net/~ondrej/+archive/ubuntu/php">PPA for PHP</a> for Ubuntu.</p><h3 id="3-1-add-surý-s-pgp-key">3.1 Add Surý&rsquo;s PGP key</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg</code></pre></div><h3 id="3-2-add-php-repo">3.2 Add PHP repo</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo sh -c <span style="color:#0086d2">&#39;echo &#34;deb https://packages.sury.org/php/ $(lsb_release -sc) main&#34; &gt; /etc/apt/sources.list.d/php.list&#39;</span></code></pre></div><p>If your server is located in Asia, use the mirror from <a href="https://xtom.com.hk/">xTom</a>:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo sh -c <span style="color:#0086d2">&#39;echo &#34;deb https://mirror.xtom.com.hk/sury/php/ $(lsb_release -sc) main&#34; &gt; /etc/apt/sources.list.d/php.list&#39;</span></code></pre></div><h3 id="3-3-update-system">3.3 Update system</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get update</code></pre></div><h3 id="3-4-install-php">3.4 Install PHP</h3><p>The default PHP version in this repository is 7.1.x. If you need 7.2.x, 7.0.x, 5.6.x, please change the corresponding PHP version numbers. (Note the configuration files.)</p><p>Below are some PHP packages that are necessary for WordPress.</p><p>Install PHP 7.2.x (mcrypt extension is no longer supported by PHP 7.2.x or later).</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install php7.2-fpm php7.2-mysql php7.2-curl php7.2-gd php7.2-mbstring php7.2-xml php7.2-xmlrpc php7.2-zip php7.2-opcache</code></pre></div><p>For PHP 7.1.x:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install php7.1-fpm php7.1-mysql php7.1-curl php7.1-gd php7.1-mbstring php7.1-mcrypt php7.1-xml php7.1-xmlrpc php7.1-zip php7.1-opcache</code></pre></div><p>For PHP 7.0.x:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install php7.0-fpm php7.0-mysql php7.0-curl php7.0-gd php7.0-mbstring php7.0-mcrypt php7.0-xml php7.0-xmlrpc php7.0-zip php7.0-opcache</code></pre></div><p>For PHP 5.6.x:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install php5.6-fpm php5.6-mysql php5.6-curl php5.6-gd php5.6-mbstring php5.6-mcrypt php5.6-xml php5.6-xmlrpc php5.6-zip php5.6-opcache</code></pre></div><p>If you want to install other extensions, you can search for the package:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-cache search php7.2* | grep php</code></pre></div><p>Edit <code>php.ini</code> to prevent <a href="https://www.owasp.org/index.php/Path_Traversal">path traversal</a> attacks. If you have installed PHP 7.1.x, edit <code>/etc/php/7.1/fpm/php.ini</code>; for PHP 7.0.x, edit <code>/etc/php/7.0/fpm/php.ini</code>; for PHP 5.6.x, edit <code>/etc/php/5.6/fpm/php.ini</code>.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo sed -i <span style="color:#0086d2">&#39;s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/&#39;</span> /etc/php/7.2/fpm/php.ini </code></pre></div><h3 id="3-5-restart-php-and-nginx">3.5 Restart PHP and Nginx</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl restart php7.2-fpm  </code></pre></div><p>For PHP 7.1.x:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl restart php7.1-fpm  </code></pre></div><p>For PHP 7.0.x:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl restart php7.0-fpm  </code></pre></div><p>For PHP 5.6.x:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl restart php5.6-fpm  </code></pre></div><p>A sample Nginx configuration file is as follows. Create a new file <code>/etc/nginx/sites-enabled/example.com.conf</code>.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-nginx" data-lang="nginx"><span style="color:#fb660a;font-weight:700">sudo</span> <span style="color:#0086d2">cat</span> <span style="color:#0086d2">&gt;&gt;</span> <span style="color:#0086d2">/etc/nginx/conf.d/example.conf</span> <span style="color:#0086d2">&lt;&lt;</span> <span style="color:#0086d2">EOF</span>
<span style="color:#0086d2">server</span> {  
        <span style="color:#fb660a;font-weight:700">listen</span> <span style="color:#0086f7;font-weight:700">80</span>;
        <span style="color:#fb660a;font-weight:700">listen</span> <span style="color:#0086d2">[::]:80</span>;

<span style="color:#080;background-color:#0f140f;font-style:italic"># Specify the website directory; you can change it based on your own demands. We recommend placing it under the /var/www directory. 
</span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>        <span style="color:#fb660a;font-weight:700">root</span> <span style="color:#0086d2">/var/www/example.com</span>;
        <span style="color:#fb660a;font-weight:700">index</span> <span style="color:#0086d2">index.php</span> <span style="color:#0086d2">index.html</span> <span style="color:#0086d2">index.htm</span>;

<span style="color:#080;background-color:#0f140f;font-style:italic"># The first domain name is the default. Replace example.com with your own domain name.
</span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>        <span style="color:#fb660a;font-weight:700">server_name</span> <span style="color:#0086d2">example.com</span>;

        <span style="color:#fb660a;font-weight:700">location</span> <span style="color:#0086d2">/</span> {
            <span style="color:#fb660a;font-weight:700">try_files</span> <span style="color:#fb660a">$uri</span> <span style="color:#fb660a">$uri/</span> =<span style="color:#0086f7;font-weight:700">404</span>;
        }

<span style="color:#080;background-color:#0f140f;font-style:italic"># Turn on PHP7.2-fpm mode. If you have installed PHP 7.1.x, change it to fastcgi_pass unix:/run/php/php7.1-fpm.sock;
</span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>        <span style="color:#fb660a;font-weight:700">location</span> ~ <span style="color:#0086d2">\.php$</span> {
            <span style="color:#fb660a;font-weight:700">include</span> <span style="color:#0086d2">snippets/fastcgi-php.conf</span>;
            <span style="color:#fb660a;font-weight:700">fastcgi_pass</span> <span style="color:#0086d2">unix:/run/php/php7.2-fpm.sock</span>;
        }
}
<span style="color:#fb660a;font-weight:700">EOF</span></code></pre></div><p>There should be no problem so far. Restart Nginx:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo systemctl restart nginx</code></pre></div><p>Our website directory has been set to <code>/var/www/example.com</code>, where we create the file <code>phpinfo.php</code> and insert the <code>phpinfo()</code> function.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo cat &gt;&gt; /var/www/example.com/phpinfo.php <span style="color:#0086d2">&lt;&lt; EOF
</span><span style="color:#0086d2">&lt;?php phpinfo(); ?&gt;
</span><span style="color:#0086d2">EOF</span></code></pre></div><p>Now visit <code>http://example.com/phpinfo.php</code> with your browser. If you see the classic <code>phpinfo</code> page (see below), then the installation should be successful. If not, go back to the previous steps.</p><p><img src="https://cdn.loli.net/sb.sb.sb/post-images/debian-lemp-phpinfo.png" alt="Debian Install LEMP PHPINFO"></p><h2 id="4-install-mysql-5-7-x-percona-server-5-7-x">4. Install MySQL 5.7.x / Percona Server 5.7.x</h2><p>Debian 9.x Stretch <a href="https://mariadb.com/resources/blog/mariadb-server-default-debian-9">uses</a> MariaDB by default. So we recommend using <a href="https://www.percona.com/downloads/Percona-Server-LATEST/">Percona Server</a>, which already supports Debian 9.x Stretch.</p><h3 id="4-1-first-import-the-official-repo-of-percona-server">4.1 First, import the official repo of Percona Server</h3><p>Add the repository acccording to the <a href="https://www.percona.com/doc/percona-server/LATEST/installation/apt_repo.html">official guide</a>:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo wget https://repo.percona.com/apt/percona-release_0.1-5.<span style="color:#fb660a;font-weight:700">$(</span>lsb_release -sc<span style="color:#fb660a;font-weight:700">)</span>_all.deb
sudo dpkg -i percona-release_0.1-5.<span style="color:#fb660a;font-weight:700">$(</span>lsb_release -sc<span style="color:#fb660a;font-weight:700">)</span>_all.deb</code></pre></div><p>Check if the corresponding <code>/etc/apt/sources.list.d/percona-release.list</code> is correct.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@debian9 ~ <span style="color:#080;background-color:#0f140f;font-style:italic"># cat /etc/apt/sources.list.d/percona-release.list 
</span><span style="color:#080;background-color:#0f140f;font-style:italic">#
</span><span style="color:#080;background-color:#0f140f;font-style:italic"># Percona releases, stable
</span><span style="color:#080;background-color:#0f140f;font-style:italic">#
</span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>deb http://repo.percona.com/apt stretch main
deb-src http://repo.percona.com/apt stretch main</code></pre></div><p>If your server is based in Asia, use the Hong Kong mirror from <a href="https://xtom.com.hk/">xTom</a>.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo sed -i <span style="color:#0086d2">&#39;s/repo.percona.com/mirror.xtom.com.hk\/percona/&#39;</span> /etc/apt/sources.list.d/percona-release.list</code></pre></div><h3 id="4-2-update-system">4.2 Update system</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get update</code></pre></div><h3 id="4-3-install-mysql-5-7-x-percona-server-5-7-x">4.3 Install MySQL 5.7.x / Percona Server 5.7.x</h3><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-get install percona-server-server-5.7</code></pre></div><p>You will be asked to enter the MySQL root password twice. Check the version after installation.</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@debian9 ~ <span style="color:#080;background-color:#0f140f;font-style:italic"># mysql -V
</span><span style="color:#080;background-color:#0f140f;font-style:italic"></span>mysql  Ver <span style="color:#0086f7;font-weight:700">14</span>.14 Distrib <span style="color:#0086f7;font-weight:700">5</span>.7.18-16, <span style="color:#fb660a;font-weight:700">for</span> debian-linux-gnu (x86_64) using  <span style="color:#0086f7;font-weight:700">7</span>.0</code></pre></div><p>After installation, it is strongly recommended to use the <code>sudo mysql_secure_installation</code> command for security configurations. For details, see the instructions in <a href="https://showf.om/blog/ubuntu-install-nginx-php-mysql/">Ubuntu Server 16.04.x (Xenial Xerus) Installing LEMP/LNMP Tutorials</a>.</p><h3 id="4-4-create-database">4.4 Create database</h3><p>Log in with MySQL root user:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql">sudo mysql -u root -p </code></pre></div><p>Create database <code>example_database</code>:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#fb660a;font-weight:700">CREATE</span> <span style="color:#fb660a;font-weight:700">DATABASE</span> example_database <span style="color:#fb660a;font-weight:700">DEFAULT</span> <span style="color:#fb660a;font-weight:700">CHARACTER</span> <span style="color:#cdcaa9;font-weight:700">SET</span> utf8mb4 <span style="color:#fb660a;font-weight:700">COLLATE</span> utf8mb4_unicode_ci; </code></pre></div><p>Create username <code>example_user</code> and grant privileges:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#fb660a;font-weight:700">GRANT</span> <span style="color:#fb660a;font-weight:700">ALL</span> <span style="color:#fb660a;font-weight:700">ON</span> example_database.* <span style="color:#fb660a;font-weight:700">TO</span> <span style="color:#0086d2">&#39;example_user&#39;</span>@<span style="color:#0086d2">&#39;localhost&#39;</span> IDENTIFIED <span style="color:#fb660a;font-weight:700">BY</span> <span style="color:#0086d2">&#39;Your strong password&#39;</span>;  </code></pre></div><p>Flush MySQL privileges:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#fb660a;font-weight:700">FLUSH</span> PRIVILEGES; </code></pre></div><p>Exit:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#fb660a;font-weight:700">EXIT</span>;</code></pre></div><p>Create new file <code>/var/www/example.com/mysql-test.php</code> for testing purpose:</p><div class="highlight"><pre style="color:#fff;background-color:#111;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo cat &gt;&gt; /var/www/example.com/mysql-test.php <span style="color:#0086d2">&lt;&lt; EOF  
</span><span style="color:#0086d2">&lt;?php  
</span><span style="color:#0086d2">\$dbname = &#39;example&#39;;    // MySQL database name
</span><span style="color:#0086d2">\$dbuser = &#39;example_user&#39;;   // MySQL username
</span><span style="color:#0086d2">\$dbpass = &#39;Your strong password&#39;;
</span><span style="color:#0086d2">\$dbhost = &#39;localhost&#39;;  // use localhost if you&#39;re installing locally
</span><span style="color:#0086d2">\$link = mysqli_connect(\$dbhost, \$dbuser, \$dbpass) or die(&#34;Unable to Connect to &#39;\$dbhost&#39;&#34;);
</span><span style="color:#0086d2">mysqli_select_db(\$link, \$dbname) or die(&#34;Could not open the db &#39;\$dbname&#39;&#34;);  
</span><span style="color:#0086d2">\$test_query = &#34;SHOW TABLES FROM \$dbname&#34;;
</span><span style="color:#0086d2">\$result = mysqli_query(\$link, \$test_query);
</span><span style="color:#0086d2">\$tblCnt = 0;
</span><span style="color:#0086d2">while(\$tbl = mysqli_fetch_array(\$result)) {  
</span><span style="color:#0086d2">  \$tblCnt++;
</span><span style="color:#0086d2">  #echo \$tbl[0].&#34;&amp;lt;br /&amp;gt;\n&#34;;
</span><span style="color:#0086d2">}
</span><span style="color:#0086d2">if (!\$tblCnt) {  
</span><span style="color:#0086d2">  echo &#34;MySQL is working fine. There are no tables.&#34;;
</span><span style="color:#0086d2">} else {
</span><span style="color:#0086d2">  echo &#34;MySQL is working fine. There are \$tblCnt tables.&#34;;
</span><span style="color:#0086d2">}
</span><span style="color:#0086d2">?&gt;
</span><span style="color:#0086d2">EOF</span></code></pre></div><p>Once the file is created, visit <code>http://example.com/mysql-test.php</code>. If the text <code>MySQL is working fine. There are no tables.</code> shows up, then your MySQL should be working properly.</p><p>With LEMP on your Debian 9.x Stretch server, you&rsquo;re all set! If you have any question, please comment below to join the discussion.</p></article></section></div><footer class="footer"><section class="container">© 2018 · Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.</section></footer></main></body></html>